# MasterTrade API 使用範例說明

這份範例說明將指導你如何使用 MasterTrade API 進行股票交易。

首先，確保你已安裝必要的程式庫並擁有 MasterTrade 的使用者名稱和密碼。

### 步驟 1: 引入必要的程式庫和模組

```python
import sys
from MasterTradePy.api import MasterTradeAPI
from MasterTradePy.model import *
from MasterTradePy.constant import Config, Exchange, PriceType, OrderType, TradingSession, Side, TradingUnit
import os
```

### 步驟 2: 初始化 API 並登入交易主機

```python
username = "YourUsername"
password = "YourPassword"

is_sim = False  # 是否連測試主機
is_force = False  # 是否單一帳號通過強制登入
is_event = False  # 是否連接競賽主機

trader = ConcreteMarketTrader()
api = MasterTradeAPI(trader)
api.SetConnectionHost('solace140.masterlink.com.tw:55555')

# 登入
rc = api.Login(username, password, is_sim, is_force, is_event)
if rc != RCode.OK:
    print("登入失敗，請檢查使用者名稱和密碼是否正確")
    sys.exit(0)
```

### 步驟 3: 使用交易功能

```python
# 下單
symbol = "2330"  # 台積電股票代號
account = "YourTradingAccount"
price = "600"  # 價格
qty = "1000"  # 股數
orderType = OrderType.ROD  # 委託類型，這裡使用當日有效

order = Order(tradingSession=TradingSession.NORMAL,
              side=Side.Buy,
              symbol=symbol,
              priceType=PriceType.LMT,
              price=price,
              tradingUnit=TradingUnit.COMMON,
              qty=qty,
              orderType=orderType,
              tradingAccount=account,
              userDef='')

rcode = api.NewOrder(order)
if rcode == RCode.OK:
    print("委託已送出")
else:
    print("下單失敗，請再次執行程式，依據回報資料修正輸入")

# 其他功能類似，可以根據需求進行操作，包括改量、改價、查詢委託回報、查詢成交回報、查詢庫存等。
```

這段程式碼是在建立一個委託訂單 `Order` 的實例，它包含了以下設定：

1. **`tradingSession=TradingSession.NORMAL`**：設定交易時段為普通交易時段。根據列舉型態 `TradingSession`，`NORMAL` 表示普通交易時段。

2. **`side=Side.Buy`**：設定買賣別為買進。根據列舉型態 `Side`，`Buy` 表示買進。

3. **`symbol=symbol`**：設定股票代號為特定的股票代號，可能是從其他地方獲取的變數或常數。

4. **`priceType=PriceType.LMT`**：設定價格類型為限價單。根據列舉型態 `PriceType`，`LMT` 表示限價單。

5. **`price=price`**：設定委託價格為特定的價格，可能是從其他地方獲取的變數或常數。

6. **`tradingUnit=TradingUnit.COMMON`**：設定交易單位為一般交易單位。根據列舉型態 `TradingUnit`，`COMMON` 表示一般交易單位。

7. **`qty=qty`**：設定委託股數為特定的股數，可能是從其他地方獲取的變數或常數。

8. **`orderType=orderType`**：設定委託方式(效期)為特定的效期類型，可能是從其他地方獲取的變數或常數。

9. **`tradingAccount=account`**：設定交易帳戶為特定的帳戶，可能是從其他地方獲取的變數或常數。

10. **`userDef=''`**：設定用戶自定義資訊為空字符串。這個屬性可能是為了讓使用者添加額外的訂單資訊，但在這個例子中沒有具體使用。

這些設定組成了一個完整的委託訂單，可以用於進行交易操作。

### 步驟 4: 程式結束

```python
api.disClient()  # 關閉 API 連線
os.system("pause")  # 在 Windows 下暫停執行以查看結果
sys.exit(0)
```

## 交易相關常數

1. **ACTION_BUY**、**ACTION_SELL**: 定義了買進和賣出操作的常數。
2. **ORDER_TYPE_ROD**、**ORDER_TYPE_IOC**、**ORDER_TYPE_FOK**: 定義了委託類型的常數，分別表示當日有效、立即成交否則取消、立即全部成交否則取消。
3. **PRICE_TYPE_LMT**、**PRICE_TYPE_MKT**: 定義了價格類型的常數，分別表示限價單和市價單。

### 列舉型態

1. **RCode**: 定義了回應碼的列舉型態，包括不同的回應狀態。
2. **Src**: 定義了交易來源的列舉型態，目前只有 API 一個選項。
3. **Exchange**: 定義了交易所的列舉型態，目前只有 TWSE 一個選項。
4. **TradingSession**: 定義了交易時段的列舉型態，包括普通、盤後、盤中零股和盤後零股。
5. **Side**: 定義了買賣別的列舉型態，包括買進和賣出。
6. **OrderType**: 定義了委託方式(效期)的列舉型態，包括當日有效、立即成交否則取消、立即全部成交否則取消。
7. **PriceType**: 定義了委託方式(價格)的列舉型態，包括限價單和市價單。
8. **TradingType**: 定義了委託別的列舉型態，目前只有集保一個選項。
9. **TradingUnit**: 定義了交易單位的列舉型態，包括一般交易單位和零股交易單位。

### 資料類型

1. **Config**: 一個資料類，包含了系統配置的各種參數。
2. **RequestType**: 定義了請求類型的列舉型態，包括 QuoteAPI 和 TradeQPI。
3. **AccountStatus**: 定義了帳戶狀態的列舉型態，包括未申請、未驗證、已驗證和已確認認證。
4. **BasicReqResult**: 定義了基本請求結果的列舉型態，包括不同的欄位索引。
5. **Market**: 定義了市場的列舉型態，包括上市、上櫃和興櫃。
6. **InventoryReqResult**: 定義了庫存請求結果的列舉型態，包括不同的庫存欄位索引。
7. **SecInvQtyResult**: 定義了證券庫存數量請求結果的列舉型態，包括不同的欄位索引。
8. **CrQtyAndDbQtyResult**: 定義了融資融券配額請求結果的列舉型態，包括不同的欄位索引。
9. **ReqResultRowType**: 定義了請求結果行類型的列舉型態，包括欄位和值。
10. **SorReqType**: 定義了 SOR 請求類型的列舉型態，包括基本、庫存、證券庫存數量、融資配額、融券配額等。
